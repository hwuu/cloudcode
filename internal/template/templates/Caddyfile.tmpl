# Auth 子域名 - 直接代理 Authelia
auth.{{ .Domain }} {
    reverse_proxy authelia:9091
}

auth.{{ .Domain }}:8443 {
    reverse_proxy authelia:9091
}

# 主域名 - OpenCode + forward_auth
{{ .Domain }} {
    forward_auth authelia:9091 {
        uri /api/authz/forward-auth
        copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
    }

    reverse_proxy devbox:4096

    log {
        output stdout
        format console
    }
}

{{ .Domain }}:8443 {
    forward_auth authelia:9091 {
        uri /api/authz/forward-auth
        copy_headers Remote-User Remote-Groups Remote-Name Remote-Email
    }

    reverse_proxy devbox:4096

    log {
        output stdout
        format console
    }
}
